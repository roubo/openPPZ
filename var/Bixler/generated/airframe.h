/* This file has been generated from /home/chorus/chorus/conf/airframes/examples/bixler_lisa_m_2.xml */
/* Please DO NOT EDIT */

#ifndef AIRFRAME_H
#define AIRFRAME_H

#define AIRFRAME_NAME "Bixler"
#define AC_ID 24
#define MD5SUM ((uint8_t*)"\341\220\225\135\057\126\250\237\070\107\047\157\075\336\036\352")

#define SERVOS_DEFAULT_NB 6
#include "subsystems/actuators/actuators_default.h"

#define SERVO_THROTTLE 1
#define SERVO_THROTTLE_NEUTRAL 1120
#define SERVO_THROTTLE_TRAVEL_UP 0.0833333333333
#define SERVO_THROTTLE_TRAVEL_UP_NUM 1
#define SERVO_THROTTLE_TRAVEL_UP_DEN 12
#define SERVO_THROTTLE_TRAVEL_DOWN 0
#define SERVO_THROTTLE_TRAVEL_DOWN_NUM 0
#define SERVO_THROTTLE_TRAVEL_DOWN_DEN 1
#define SERVO_THROTTLE_MAX 1920
#define SERVO_THROTTLE_MIN 1120

#define SERVO_ELEVATOR 2
#define SERVO_ELEVATOR_NEUTRAL 1515
#define SERVO_ELEVATOR_TRAVEL_UP 0.0401041666667
#define SERVO_ELEVATOR_TRAVEL_UP_NUM 77
#define SERVO_ELEVATOR_TRAVEL_UP_DEN 1920
#define SERVO_ELEVATOR_TRAVEL_DOWN 0.0432291666667
#define SERVO_ELEVATOR_TRAVEL_DOWN_NUM 83
#define SERVO_ELEVATOR_TRAVEL_DOWN_DEN 1920
#define SERVO_ELEVATOR_MAX 1900
#define SERVO_ELEVATOR_MIN 1100

#define SERVO_RUDDER 3
#define SERVO_RUDDER_NEUTRAL 1440
#define SERVO_RUDDER_TRAVEL_UP 0.0635416666667
#define SERVO_RUDDER_TRAVEL_UP_NUM 61
#define SERVO_RUDDER_TRAVEL_UP_DEN 960
#define SERVO_RUDDER_TRAVEL_DOWN 0.0510416666667
#define SERVO_RUDDER_TRAVEL_DOWN_NUM 49
#define SERVO_RUDDER_TRAVEL_DOWN_DEN 960
#define SERVO_RUDDER_MAX 2050
#define SERVO_RUDDER_MIN 950

#define SERVO_AILERON_RIGHT 4
#define SERVO_AILERON_RIGHT_NEUTRAL 1500
#define SERVO_AILERON_RIGHT_TRAVEL_UP 0.0520833333333
#define SERVO_AILERON_RIGHT_TRAVEL_UP_NUM 5
#define SERVO_AILERON_RIGHT_TRAVEL_UP_DEN 96
#define SERVO_AILERON_RIGHT_TRAVEL_DOWN 0.0520833333333
#define SERVO_AILERON_RIGHT_TRAVEL_DOWN_NUM 5
#define SERVO_AILERON_RIGHT_TRAVEL_DOWN_DEN 96
#define SERVO_AILERON_RIGHT_MAX 2000
#define SERVO_AILERON_RIGHT_MIN 1000

#define SERVO_AILERON_LEFT 5
#define SERVO_AILERON_LEFT_NEUTRAL 1500
#define SERVO_AILERON_LEFT_TRAVEL_UP 0.0520833333333
#define SERVO_AILERON_LEFT_TRAVEL_UP_NUM 5
#define SERVO_AILERON_LEFT_TRAVEL_UP_DEN 96
#define SERVO_AILERON_LEFT_TRAVEL_DOWN 0.0520833333333
#define SERVO_AILERON_LEFT_TRAVEL_DOWN_NUM 5
#define SERVO_AILERON_LEFT_TRAVEL_DOWN_DEN 96
#define SERVO_AILERON_LEFT_MAX 2000
#define SERVO_AILERON_LEFT_MIN 1000


#define COMMAND_THROTTLE 0
#define COMMAND_ROLL 1
#define COMMAND_PITCH 2
#define COMMAND_YAW 3
#define COMMANDS_NB 4
#define COMMANDS_FAILSAFE {0,0,0,2000}


#define SetCommandsFromRC(_commands_array, _rc_array) { \
  _commands_array[COMMAND_ROLL] = _rc_array[RADIO_ROLL];\
  _commands_array[COMMAND_PITCH] = _rc_array[RADIO_PITCH];\
  _commands_array[COMMAND_THROTTLE] = _rc_array[RADIO_THROTTLE];\
  _commands_array[COMMAND_YAW] = _rc_array[RADIO_YAW];\
}

#define SECTION_MIXER 1
#define COMBI_SWITCH 0.3

#define SERVO_AILERON_LEFT_IDX 0
#define Set_AILERON_LEFT_Servo(_v) { \
  actuators[SERVO_AILERON_LEFT_IDX] = Chop(_v, SERVO_AILERON_LEFT_MIN, SERVO_AILERON_LEFT_MAX); \
  ActuatorDefaultSet(SERVO_AILERON_LEFT, actuators[SERVO_AILERON_LEFT_IDX]); \
}

#define SERVO_RUDDER_IDX 1
#define Set_RUDDER_Servo(_v) { \
  actuators[SERVO_RUDDER_IDX] = Chop(_v, SERVO_RUDDER_MIN, SERVO_RUDDER_MAX); \
  ActuatorDefaultSet(SERVO_RUDDER, actuators[SERVO_RUDDER_IDX]); \
}

#define SERVO_ELEVATOR_IDX 2
#define Set_ELEVATOR_Servo(_v) { \
  actuators[SERVO_ELEVATOR_IDX] = Chop(_v, SERVO_ELEVATOR_MIN, SERVO_ELEVATOR_MAX); \
  ActuatorDefaultSet(SERVO_ELEVATOR, actuators[SERVO_ELEVATOR_IDX]); \
}

#define SERVO_AILERON_RIGHT_IDX 3
#define Set_AILERON_RIGHT_Servo(_v) { \
  actuators[SERVO_AILERON_RIGHT_IDX] = Chop(_v, SERVO_AILERON_RIGHT_MIN, SERVO_AILERON_RIGHT_MAX); \
  ActuatorDefaultSet(SERVO_AILERON_RIGHT, actuators[SERVO_AILERON_RIGHT_IDX]); \
}

#define SERVO_THROTTLE_IDX 4
#define Set_THROTTLE_Servo(_v) { \
  actuators[SERVO_THROTTLE_IDX] = Chop(_v, SERVO_THROTTLE_MIN, SERVO_THROTTLE_MAX); \
  ActuatorDefaultSet(SERVO_THROTTLE, actuators[SERVO_THROTTLE_IDX]); \
}

#define ACTUATORS_NB 5

#define SetActuatorsFromCommands(values) { \
  int32_t servo_value;\
  int32_t command_value;\
\
  command_value = values[COMMAND_THROTTLE]; \
  command_value *= command_value>0 ? SERVO_THROTTLE_TRAVEL_UP_NUM : SERVO_THROTTLE_TRAVEL_DOWN_NUM; \
  command_value /= command_value>0 ? SERVO_THROTTLE_TRAVEL_UP_DEN : SERVO_THROTTLE_TRAVEL_DOWN_DEN; \
  servo_value = SERVO_THROTTLE_NEUTRAL + command_value; \
  Set_THROTTLE_Servo(servo_value); \
\
  command_value = values[COMMAND_PITCH]; \
  command_value *= command_value>0 ? SERVO_ELEVATOR_TRAVEL_UP_NUM : SERVO_ELEVATOR_TRAVEL_DOWN_NUM; \
  command_value /= command_value>0 ? SERVO_ELEVATOR_TRAVEL_UP_DEN : SERVO_ELEVATOR_TRAVEL_DOWN_DEN; \
  servo_value = SERVO_ELEVATOR_NEUTRAL + command_value; \
  Set_ELEVATOR_Servo(servo_value); \
\
  command_value = values[COMMAND_YAW] + values[COMMAND_ROLL]*COMBI_SWITCH; \
  command_value *= command_value>0 ? SERVO_RUDDER_TRAVEL_UP_NUM : SERVO_RUDDER_TRAVEL_DOWN_NUM; \
  command_value /= command_value>0 ? SERVO_RUDDER_TRAVEL_UP_DEN : SERVO_RUDDER_TRAVEL_DOWN_DEN; \
  servo_value = SERVO_RUDDER_NEUTRAL + command_value; \
  Set_RUDDER_Servo(servo_value); \
\
  command_value = values[COMMAND_ROLL]; \
  command_value *= command_value>0 ? SERVO_AILERON_LEFT_TRAVEL_UP_NUM : SERVO_AILERON_LEFT_TRAVEL_DOWN_NUM; \
  command_value /= command_value>0 ? SERVO_AILERON_LEFT_TRAVEL_UP_DEN : SERVO_AILERON_LEFT_TRAVEL_DOWN_DEN; \
  servo_value = SERVO_AILERON_LEFT_NEUTRAL + command_value; \
  Set_AILERON_LEFT_Servo(servo_value); \
\
  command_value = values[COMMAND_ROLL]; \
  command_value *= command_value>0 ? SERVO_AILERON_RIGHT_TRAVEL_UP_NUM : SERVO_AILERON_RIGHT_TRAVEL_DOWN_NUM; \
  command_value /= command_value>0 ? SERVO_AILERON_RIGHT_TRAVEL_UP_DEN : SERVO_AILERON_RIGHT_TRAVEL_DOWN_DEN; \
  servo_value = SERVO_AILERON_RIGHT_NEUTRAL + command_value; \
  Set_AILERON_RIGHT_Servo(servo_value); \
\
  ActuatorsDefaultCommit();\
}

#define AllActuatorsInit() { \
  ActuatorsDefaultInit();\
}

#define SECTION_AUTO1 1
#define AUTO1_MAX_ROLL 0.872664625
#define AUTO1_MAX_PITCH 0.6981317

#define SECTION_IMU 1
#define IMU_BODY_TO_IMU_PHI 0.
#define IMU_BODY_TO_IMU_THETA 0.
#define IMU_BODY_TO_IMU_PSI 0.

#define SECTION_INS 1
#define INS_ROLL_NEUTRAL_DEFAULT 0.
#define INS_PITCH_NEUTRAL_DEFAULT 0.

#define SECTION_BAT 1
#define MILLIAMP_AT_FULL_THROTTLE 20000
#define CATASTROPHIC_BAT_LEVEL 9.0
#define CRITIC_BAT_LEVEL 9.5
#define LOW_BAT_LEVEL 10.0
#define MAX_BAT_LEVEL 12.5

#define SECTION_MISC 1
#define NOMINAL_AIRSPEED 15.
#define CARROT 4.
#define KILL_MODE_DISTANCE (2.0*MAX_DIST_FROM_HOME)
#define ALT_KALMAN_ENABLED TRUE
#define DEFAULT_CIRCLE_RADIUS 100.

#define SECTION_VERTICAL CONTROL 1
#define V_CTL_POWER_CTL_BAT_NOMINAL 11.0
#define V_CTL_ALTITUDE_PGAIN 0.075
#define V_CTL_ALTITUDE_MAX_CLIMB 4.
#define V_CTL_AUTO_THROTTLE_NOMINAL_CRUISE_THROTTLE 0.5
#define V_CTL_AUTO_THROTTLE_MIN_CRUISE_THROTTLE 0.2
#define V_CTL_AUTO_THROTTLE_MAX_CRUISE_THROTTLE 1.0
#define V_CTL_AUTO_THROTTLE_LOITER_TRIM 1500
#define V_CTL_AUTO_THROTTLE_DASH_TRIM -1000
#define V_CTL_AUTO_THROTTLE_CLIMB_THROTTLE_INCREMENT 0.1
#define V_CTL_AUTO_THROTTLE_PGAIN 0.02
#define V_CTL_AUTO_THROTTLE_IGAIN 0.03
#define V_CTL_AUTO_THROTTLE_PITCH_OF_VZ_PGAIN 0.05
#define V_CTL_AUTO_PITCH_PGAIN 0.125
#define V_CTL_AUTO_PITCH_IGAIN 0.025
#define V_CTL_AUTO_PITCH_MAX_PITCH 0.4363323125
#define V_CTL_AUTO_PITCH_MIN_PITCH -0.4363323125
#define V_CTL_THROTTLE_SLEW 1.0

#define SECTION_HORIZONTAL CONTROL 1
#define H_CTL_COURSE_PGAIN 1.0
#define H_CTL_COURSE_DGAIN 0.4
#define H_CTL_ROLL_MAX_SETPOINT 0.6108652375
#define H_CTL_PITCH_MAX_SETPOINT 0.4363323125
#define H_CTL_PITCH_MIN_SETPOINT -0.4363323125
#define H_CTL_PITCH_PGAIN 20000.
#define H_CTL_PITCH_DGAIN 1.5
#define H_CTL_ELEVATOR_OF_ROLL 2500
#define H_CTL_ROLL_ATTITUDE_GAIN 7400
#define H_CTL_ROLL_RATE_GAIN 200

#define SECTION_FAILSAFE 1
#define FAILSAFE_DELAY_WITHOUT_GPS 3
#define FAILSAFE_DEFAULT_THROTTLE 0.4
#define FAILSAFE_DEFAULT_ROLL 0.2617993875
#define FAILSAFE_DEFAULT_PITCH 0.
#define FAILSAFE_HOME_RADIUS 90


#endif // AIRFRAME_H
